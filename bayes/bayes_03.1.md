---
marp: true
theme: default
pagination: true
---

# ベイズ統計入門 Vol 3.1

---

## 理論と実践の世界を行き来する

- 正規分布までの歴史

---

確率の肌感覚

例題: コイントスの表率は$\frac{1}{2}$である

-> n 回投げたら n/2 回くらいは表が出るだろう
**最も起こりやすいのは n/2 回**

では n/2 回以外はどれくらい起こりやすい?

---

確率の肌感覚 2

例題: 物体 A までの距離を測ったら $\{{201,203,195,201\}}$だった
この A までの真の距離は?

-> 測定にはずれがある
とりあえず平均をとって**真の値は 200 ぐらいだろう**

一度も 200 という数字が出てないが 200 というのは確かなのだろうか?

---

### 離散分布

公正なコインを考える

- 結果は 2 通り${表=1,裏=0}$
- 公正なコインなら表率は $\frac{1}{2}$

```py
def try_coin() -> int:
    return 1 if numpy.random.rand() < 0.5 else 0
```

`numpy.random.rand()`の定義域は$[0.0,1.0)$

---

#### 1/2 の意味するところ

試行で本当に表率が 1/2 かどうか確かめる。

例えば

1. 2 回投げたら 1 回表が出た
2. 2 回投げたら 2 回表になった
3. 2 回投げたら 0 回表になった
4. 2 回投げたら 0 回表になった

これを一般化: n 回投げたら k 回表になる

---

プログラムを使って試してみる
n 回投げる試行を 10000 回試してその回数を数える

![bg right height:600px](img/03.1_binominal.png)

中央が高くなっていく

---

Python コード例

```py
import numpy
import matplotlib.pyplot as plt
from functools import reduce

def try_coin() -> int:
    return 1 if numpy.random.rand() < 0.5 else 0

def coin_plot(n,m) -> int:
    d = []
    for v in range(0, m):
        sum = reduce(lambda a, b: a + try_coin(), range(0,n+1))
        d.append(sum)


    fig = plt.figure()
    ax = fig.add_subplot(1,1,1)
    ax.hist(d,bins=n+1)
    ax.set_title('try coin n={0} exec {1}'.format(n,m))
    ax.set_xlabel('k')
    ax.set_ylabel('count')
    fig.show()

coin_plot(1,10000)
coin_plot(2,10000)
coin_plot(4,10000)
coin_plot(8,10000)
coin_plot(16,10000)

```

---

中央が高くなる理由 = パスカルの三角形
組み合わせの数は n/2 のケースが最も多くなる

${}_nC_k = \frac{n!}{k!(n-k)!}$
e.g. ${}_{10}C_5 = \frac{1*2*3*4*5*6*7*8*9*10}{1*2*3*4*5*(1*2*3*4*5)}$

---

#### ド・モアブル(De Moivre, 1733)

2 項分布をもっと簡単に計算したい

1. n 回という試行は指数でふえて計算が大変 -> 指数だけを数えよう
1. 2 項分布において確率の最大は $n/2$ となる(パスカルの三角形)
1. $n/2$から$d$離れるほど確率が$ln(-\frac{d^2}{n/2}/m)$小さくなる

当時はまだ存在していない、現代で言う正規分布による近似

---

### 連続分布

例題: 物体 A までの距離を測ったら $\{{201,203,195,201\}}$だった
この A までの距離はどれくらいだろう?

1800 年頃の天文学で同様の問題

天体の運動や地球の大きさを知るのに天体観測の情報を扱う。
星の位置や測量の素データから**正確な値**を計算したい

---

### ガリレオ(Galileo, 1632)の考察

1. 地球の中心と天体との距離を表現する真値が存在する
2. 全ての観察値には，観察者，観測器具，観測条件に起因する誤差が付属する
3. 観測値は真値の周りに対称的に分布する。従って誤差は 0 の周りに対称的に分布する
4. 小さな誤差は大きな誤差より高頻度である
5. 距離の計算値は角度測定値の関数として定まり，観測の微小な調整が距離の巨大な調整につながることもある

誤差を求めて補正したいというのが始まり

---

$測定値 = 真の値 + 誤差$ というモデル化をした。
誤差の分布が分かれば真の値が分かる

当時は経験的に複数の測定値の平均を使っていた。
しかし平均値が誤差に対してどれくらい確からしいか誰も分かっていない

---

#### ダニエル・ベルヌーイ(Daniel Bernoulli, 1778)

半円形の誤差分布を提案し、
平均ではなく誤差分布から尤もらしさが最大になる物を真の値とする
**最尤法** を提案した。
(半円形の誤差分布では)平均値は最尤推定値にならない事を証明 -> どういう誤差分布が良い?

![](img/03.1_galileo_error.png)

---

#### ガウス(Gauss, 1809)

最小二乗法の理論的研究から正規分布を導き出した

ガウスの考察

1. 小さな誤差は大きな誤差より起こりやすい
2. 誤差の分布は対称形
3. 算術平均は求めたい値の最確値でなければならない

---

3 番目の項について

- 真の値$M$の測定値$x_1,x_2,\dots,\x_n$がある
- 観測誤差として未知の確率密度$\varphi$がある
- 誤差は$x_1 - M, x_2 - M, \dots, x_n - M$である

$Q = \prod_{i=1}^{n}\varphi(x_i - M)$ を最大にできる M が尤もらしい M である。

---

1. 平均値で確率が最大になるとする <- 仮定
1. すべての可能性を積分($\exp^x$)する
1. 平均から離れるほど値が小さくなる($-(x - avg)^2$)
1. 合計が 1 になる

平均値=最尤値であるべきという信念のもとで正規分布が求められる
$\varphi(x) = \sqrt{a/\pi}\exp^{(-ax^2)}$となる

---

### Young と Hagen

誤差は**無数の小さな誤差が積み重なって観測誤差**になるという考えかた
根源誤差論

根源誤差は 2 点分布であり −a, a のどちらかの値を 1/2 の確率で取る、
つまり**二項分布をとる**とする
負の誤差が$m$正の誤差が$n-m$個ある

$f(E) = f((n-2m)a) = \frac{n!}{m!(n-m)!\frac{1}{2}^n}$

---

誤差が-a か a などはかなり乱暴ではあるが 2 つの重要な点がある

1. 2 項分布は試行を繰り返すので負の値が存在しなかった
   中心からの幅 a により中央と分散を与えられる解釈が可能になった
1. ガリレオなどの誤差分布の定義は真の値の存在の推定するものだったが
   二項分布は**集合の性質を表している**。そこから求められた正規分布も真の値を仮定しないもの適用できる

---

### 誤差法則の妥当性

誤差法則は理論的な発展をして妥当であろうと言われているが、当然現実のデータとして妥当性を示さなければならない

ラプラス、ガウスは天文学の研究をしていた
ガウスの正規分布導出は太陽のまわりを回る天体の運動理論で行われており、天文学の観測が正規分布に従う妥当性は示されていた

---

#### ケトレー(Quételet, 1845, 1846)

「人間とその能力の発展について－社会物理学の試み」で
社会や人間の身体に関する計量的測定値が、天文学と同じように正規分布に従うことを発見した

---

一般的な確率事象として誤差は正規分布に従う事が示された
-> 統計学の発展へと至る

正規分布の定義$f(x) = \frac{1}{\sqrt{2\pi\sigma^2}}exp(-\frac{(x-\mu)^2}{2\sigma^2})$

---

## まとめ

確率分布は**集合の性質**を示すもので、無限回の試行の結果得られるであろう可能性を描いたもの

正規分布の妥当性は、試行の中に無数の誤差要因が含まれておりそれが正規分布とよく近似するという理論と現実データから示されている

$真の値 + 誤差$というのは解釈の一つ

---

## Reference

- 「確率の哲学的試論」ラプラス著
- [七つの正規分布](https://www.jstage.jst.go.jp/article/sjpr/56/1/56_7/_article/-char/ja/)
