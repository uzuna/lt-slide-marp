---
marp: true
theme: default
pagination: true
---

# ベイズ統計入門 Vol.1 第 3 版

---

## Why ベイズ

- 未知のリスクを検討したい
- 難しい意思決定をするために
- 少なくて不確かなデータから少しでも情報を得る

## Topic

- 確率
- 条件付き確率
- ベイジアンネットワークの触り

---

### 確率

赤毛の男はなんとしてもお金を増やさなければならない
誰かが一財産を稼いだことがあるという、うわさの酒場に入った

---

近くのテーブルではコイントスのゲームをしている

1. 1 回投げて表だったら掛け金の 2 倍
1. 4 回投げてすべて表なら掛け金の 10 倍
1. 1 つの 6 面サイコロで出た目が 2 以下なら 2 倍

それ以外の場合に掛け金は没収される
勝つためにはどれを選ぶのが良いだろうか?

---

確率とは **試行(trial)** によって得られた **事象(event)** の割合で表現される
**偶然起こる事象の起こりやすさの指標**

1. コインは **表**か**裏**のふたつしか出ない。
   表になる確率は $\frac{表}{表、裏} = \frac{1}{2}$
1. 確率の合計は 1 になる。表の確率が$\frac{1}{2}$なら裏の確率は$(1-\frac{1}{2}) = \frac{1}{2}$

![](img/coin_simple.png)

---

#### 面積で表現すると分かりやすい

1. コイン 4 回ですべて表なら$\frac{1}{2^4} = \frac{1}{16}$
1. 6 面サイコロで特定の目 $\frac{1}{6}$
1. 6 面サイコロで 2 以下 $\frac{2}{6}$

![](img/coin_4try.png) ![](img/dice.png)

---

確率は$\frac{条件を満たす事象の数}{とりうる事象の数}$

1. コインが表になる確率は $\frac{1}{2}$
1. 6 面サイコロで特定の目 $\frac{1}{6}$

ということは

1. COVID-19 の PCR 検査で陽性になる確率は $\frac{陽性}{陽性, 陰性} = \frac{1}{2}$ ... :thinking:

---

実際の確率は測ってみないとわからない **統計的確率**
PCR の測定データ

- 検査の精度: **70%**
- 検査の特異度: **99.9%**
- 東京都の 2020/01/08 の測定値: **16%**

:thinking::thinking::thinking:

---

### 条件付き確率

$P(A|B)$: B という事象を満たしているときに A が起きる確率

---

PCR 検査は精度と特異度が測定されている
感染している事象を$A$としたら、感染している確率は$P(A)$と表記する

- 精度: **70%**
  - 感染者を検査したときに陽性になる確率-> $P(陽性|A)$
- 特異度: **99.9%**
  - 非感染者を検査したら陰性になる確率-> $P(陰性|\overline{A})$
- 東京都の 2020/01/08 の測定値: **16%**
  - 感染が疑われる人が陽性になった確率 -> $P(陽性|A) + P(陽性|\overline{A})$

---

イメージ図
![bn_pcr](img/covid19_table.png)

全員が感染しているなら陽性率は 70%になるのがもっともらしい

---

PCR 検査の例

$0.16$の意味とは?日本でコロナ感染している比率...ではないし検査の精度でもない。
そもそも下記のように変化している。

![Trend](img/covid19_tokyo_trend.png)

---

測定結果の陽性率は感染者と非感染者の比率の影響を受ける
![bn_pcr](img/covid19_table.png)

$$
P(陽性) = P(陽性|A)P(A)+P(陽性|\overline{A})P(\overline{A}) \\
= 0.7*P(A) + 0.001*P(\overline{A}) \\
= 0.16
$$

この場合$P(A)$ 検査対象の集団は 22.7%が実際には感染しており、
8%ほどが感染しているのに陰性判定になっていると推測できる

---

確率には前提条件がある

- **表率が 1/2 の確率のコイン**を使うと、表になる確率は 1/2
- **同様に確からしいサイコロ**を投げると特定の目の出る確率は 1/6
- **感染している時**に PCR 検査を受けると陽性が出る確率は 70%

このように考えるのが**条件付き確率**

---

前提条件によって得られる確率が変わる

- 感染しているかどうかで PCR 検査の陽性率は異なる
- 表率が 60%のコインなら 表が出るもっともらしい確率は 60%になる

---

確率の高いゲームを選べば勝てる。
**原因が分かれば結果は予想しやすい**
しかし私たちは原因を直接知ることはできない

欲しいのは結果から原因を推定すること、つまり逆確率(=事後確率)

---

酒場を見渡すとフードの二人組が何やら話し合っているのが見えた
赤毛はこういうのを盗み聞くのが得意だった

このフードたちは各テーブルの結果を数えているらしく次の情報が得られた

| テーブル | 表の回数 | 裏の回数 |
| :------- | :------- | :------- |
| A        | 60       | 40       |
| B        | 50       | 50       |
| C        | 40       | 60       |

---

1 回表を当てたら掛け金が 2 倍になるゲームの期待値

- A $コインの表率 = \frac{60}{60+40} = 0.6$ -> 期待値 $1.2$
- B $コインの表率 = \frac{50}{50+50} = 0.5$ -> 期待値 $1.0$
- C $コインの表率 = \frac{40}{40+60} = 0.4$ -> 期待値 $0.8$

![](img/table_coin.png)
赤毛はこれなら勝てると思いテーブル A へと向かった...

---

### ベイジアンネットワーク

陽性率の変化は検査の結果を支配するパラメータが変わっている事を示す

![bn_pcr](img/bn_pcr.png)

---

### 実例 1

スペースシャトル チャレンジャー号の事故

1. 失敗したときには被害が甚大
1. 失敗する可能性=リスクを評価したい
1. 事故にならなかったが以前から O-Ring の破損は起きていた

![bn_pcr](img/bn_space_shuttle.png)

---

### 実例 2

保険における推定

1. 保険料は十分な利益と支払い額を保ちつつ安く抑えたい
1. A という人の保険料はどう決めれば良い?

![bn_credible](img/bn_credible.png)

---

### 例 3

賭け事

1. ギャンブルに勝ちたい
1. 操作されていない確率が知りたい
1. これまでのゲームの結果におかしなところはない?

![bn_coin_game](img/bn_coin_game.png)

---

まとめ

- 確率
- 条件付き確率
- ベイジアンネットワークの触り

---

次回

- ベイズの定理
- ベイジアンネットワークの実例

---

### 参考書籍

- 『異端の統計学ベイズ』著: シャロン・バーチュ・マグレイン
- 『図説これならわかるベイズ統計学』著: 涌井良幸、涌井貞美
- 『完全独習ベイズ統計学入門』著: 小島寛之
- 『ベイズ推論による機械学習入門』著: 須山敦志

---

### 参照 webpage

- [ベイズ推論と機械学習](https://courses.wshito.com/semi2/2019-bayes-AI/)
- [損保総研レポート](http://www.sonposoken.or.jp/media/reports/sonposokenreport083_2.pdf)
- [東京都新型コロナウイルス感染症対策サイト](https://stopcovid19.metro.tokyo.lg.jp/cards/positive-rate/)
